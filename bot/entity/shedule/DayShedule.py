# –ö–ª–∞—Å—Å DaySchedule –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
from bot.entity.shedule.TimeInterval import TimeInterval


# –ö–ª–∞—Å—Å DaySchedule –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –æ–¥–Ω–æ–≥–æ –¥–Ω—è
class DaySchedule:
    def __init__(self):
        # –°–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –≤—Ä–µ–º–µ–Ω–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–Ω—è—Ç–∏–π
        self.schedule = []

    def add_lesson(self, time_interval: TimeInterval, description: str):
        """
        –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç TimeInterval.
        """
        # –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–Ω—è—Ç–∏–µ –≤ —Å–ø–∏—Å–æ–∫
        self.schedule.append((time_interval, description))

        # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞
        self.schedule.sort(key=lambda x: x[0].start)

    def __iter__(self):
        """
        –ò—Ç–µ—Ä–∞—Ç–æ—Ä, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π –∑–∞–Ω—è—Ç–∏—è –ø–æ –ø–æ—Ä—è–¥–∫—É (–≤ –ø–æ—Ä—è–¥–∫–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞).
        """
        for interval, description in self.schedule:
            yield interval, description

    def __str__(self):
        """
        –°—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
        1. –ø—Ä.–ü—Ä–∞–≤–æ–≤–æ–µ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
           –ø—Ä–æ—Ñ.–ì—Ä–∏—à–∫–æ –ê.–Ø.   465 C
           ‚è∞ 08:10 - 09:45
        """
        formatted_schedule = []
        for i, (interval, description) in enumerate(self.schedule, start=1):
            # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π, –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ –≤—Ä–µ–º–µ–Ω–µ–º

            formatted_schedule.append(
                f"<b><i> {i}. {description}</i></b>\n"
                f"   ‚è∞ {interval.start.strftime('%H:%M')} - {interval.end.strftime('%H:%M')}"
            )

        return "<blockquote>üìÜ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è </blockquote> "+"\n\n".join(formatted_schedule)

    def has_lessons(self) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞, –µ—Å—Ç—å –ª–∏ –∑–∞–Ω—è—Ç–∏—è –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å.
        """
        return len(self.schedule) > 0

#         schedule_message += \
#         """
# <blockquote>üìÜ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è </blockquote>
#
# \t1. <b><i>–ø—Ä.–ü—Ä–∞–≤–æ–≤–æ–µ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
# –ø—Ä–æ—Ñ.–ì—Ä–∏—à–∫–æ –ê.–Ø.   465 C</i></b>
# ‚è∞ 08.10 - 09.45\n
# \t2. <b><i> –ª.–§–∏–∑–∏—á–µ—Å–∫–∞—è –∫—É–ª—å—Ç—É—Ä–∞ –∏ —Å–ø–æ—Ä—Ç
#    –°–ø–æ—Ä—Ç–∑–∞–ª C </i></b>
# ‚è∞ 09.55 - 11.30
#         """
#             # "1. –õ–µ–∫—Ü–∏—è –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É –¢–ò–ò, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –û—Ä–µ—à–∫–æ–≤ –í.–ò., \n" \
#
#                            # "\tüö™ –ê—É–¥–∏—Ç–æ—Ä–∏—è: 128\n" \
#                            # "\t‚è∞ –í—Ä–µ–º—è: 13:35 ‚Äì 15:10\n\n" \
#                            # "2. –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É –¢–ò–ò, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –û—Ä–µ—à–∫–æ–≤ –í.–ò.\n" \
#                            # "\tüö™ –ê—É–¥–∏—Ç–æ—Ä–∏—è: 128\n" \
#                            # "\t‚è∞ –í—Ä–µ–º—è: 15:20 ‚Äì 16:55